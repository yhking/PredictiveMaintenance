# 预测性维护案例

[微软 Azure AI Gallery](https://gallery.azure.ai/Collection/Predictive-Maintenance-Template-3)
## 1. 简介
预测性维护是一个综合性的概念，它包括但不限于：**故障预测，故障诊断（根因分析），故障探测，故障分类，故障发生前的缓解建议，故障发生后的维护行动。**

预测性维护重点关注：预测长期运行的机器何时会发生故障的技术。这项技术通过学习大量与机器运行状态相关的先验知识，生成预测模型。该模型输入机器的实时运行状态数据，输出机器故障发生时间点或故障维护建议，从而实现设备故障时间的预判，并提前执行维护工作，降低维护成本。

本预测性维护案例致力于解决三大类问题：
1. 回归问题：预测剩余使用寿命（RUL， Remaining Useful Life）,失效时间（TTF，Time to Failure）;
2. 二分类问题：预测在某一特定时间段内，设备是否会故障；
3. 多分类问题：预测在多个不同时间段内，设备是否会发生故障

注：上述问题的时间单位可以按工时，周期，里程碑，事物发展等具体业务场景来确定。

本预测性维护模型基于虚拟飞机引擎的运行-故障事件记录构建。**进行设备故障预测性维护前提**：设备工作时满足渐进的退化模式，该模式反映在设备的传感器测量中。 通过检查设备传感器的时序采样值，机器学习算法可以学习传感器采集值和变化值，及其相对于历史故障值之间的关系，来预测未来的故障。 具体过程设计以下三个步骤：

1. 数据准备和特征工程

2. 训练和评估下面三种模型
   * 回归模型
   * 二分类模型
   * 多分类模型

3. 使用上述三种模型部署web服务器

## 2. 数据准备与特征工程
### 2.1 数据准备
#### 数据集

* 训练数据：飞机引擎从正常运行到出故障的完整运行状态数据的时序记录；
* 测试数据：飞机引擎还未发生故障的运行状态数据的时序记录；
* 验证数据：测试数据的后半段运行数据（发生故障的时间点标识）。

#### 数据采集
* 训练数据：按一定周期采集，确保第一个周期采集的数据为设备正常运行数据，最后一个周期采集的数据为设备异常运行数据（超过正常门限值），即训练数据集涵盖设备由正常到故障的整个过程。
* 测试数据：和训练数据类似，但是最后一个周期采集的数据并不是异常运行数据点，此时设备运行正常，但是不知道到底要经过多少个周期，才能遇到故障点。
* 验证数据：直接给出每个测试设备之后发生异常时的采集周期值。

#### 数据标签
* 回归模型：目前这个正常运行的设备还需要多少个周期才会发生故障。
* 二分类模型：设备是否会在未来某个时间点发生故障
* 多分类模型：15天故障预警，30天故障预警，，，，即判断未来不同时间点是否会发生故障。

![数据标签](https://az712634.vo.msecnd.net/samplesimg/v1/T4/labeling_1.png)

### 2.2 特征工程
特征数据的来源：
* 原始特征：从原始的采集数据中挑选合适的特征，这个过程需要丰富的专业领域知识。
* 聚合特征：总结历史数据集，经过算法运算处理，转换为新的特征。（一段时间内采集数据的平均值或方差，采集值变动的范围，采集值相对于初始值的差值，采集值变化的速率，超过安全阈值的特征点个数）

**经验提示**：时变特征的提取，注意采集时间的粒度（例如某个故障每两个月发生一次，采样周期按天和周计比按秒计效果会更好，从另一方面改善了正常运行数据和故障数据的分布不平衡性问题）

## 3. 模型训练与评估
第一章节讲过预测性维护模型按使用场景划分，主要涉及三大类：回归模型，二分类模型，多分类模型。尽管三者的训练与评估方法各不相同（后文会依次展开），但是他们依然有一些共同之处，说明如下：

* 享有共同的训练测试数据集和流程 
* 享有共同的特征工程来挑选特征
  
### 3.1 回归模型

### 3.2 二分类模型
### 3.3 多分类模型